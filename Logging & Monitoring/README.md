# Monitoring Solution for Kubernetes

- k8s does not have the inbuilt monitoring solution. There are many open-source tools such as Prometheus, Datadog, etc. for monitoring metrics for the k8s cluster and its components.

- In Kubernetes, metrics and events are important components that provide information about the state and behavior of the cluster, applications, and resources. Let's explore each of them in more detail:

1. **Metrics:** Metrics in Kubernetes refer to quantitative measurements that provide insights into the performance and resource utilization of various components within the cluster. They help monitor the health, efficiency, and capacity of the cluster and its resources. Metrics are typically collected and exposed by Kubernetes components like the Kubernetes API server, kubelet, and various monitoring solutions. Kubernetes uses the Metrics API (also known as the "Metrics Server") to collect and expose resource utilization metrics such as CPU and memory usage, network traffic, and storage utilization for pods, nodes, and other resources. These metrics can be used to monitor and autoscale applications, troubleshoot performance issues and make informed decisions about resource allocation.

2. **Events:** Events in Kubernetes provide information about significant occurrences within the cluster, such as changes in the state of resources or important system-level events. They are generated by Kubernetes components, controllers, and operators to report various types of activities, including pod creations, deletions, updates, failures, and other lifecycle events. Events serve as a way to track and debug the behavior of resources and the cluster itself. They provide valuable insights into the state transitions and actions taking place within the Kubernetes environment. Events can be viewed using the `kubectl` command-line tool or queried via the Kubernetes API. They are especially useful for troubleshooting, identifying issues, and understanding the sequence of events leading up to a problem.

Overall, metrics and events play crucial roles in monitoring, managing, and diagnosing Kubernetes clusters. Metrics provide quantitative data for performance analysis and scaling decisions, while events offer a log of important occurrences and state changes. Both metrics and events contribute to observability and enable effective cluster management and application monitoring in Kubernetes environments.
## Kubernetes metrics server
- k8s have the metrics server which monitors the k8s cluster resources and saves logs to the in-memory database of the metrics server. It does not keep logs on the system.
- Apart from minikube for other tools we need to download the k8s metrics server from github and apply it to the k8s cluster.
``` bash 
>>> https://github.com/kubernetes-sigs/metrics-server

>>> k apply -f . 
```
## Checking logs with the metrics server
- `k top nodes` - to get node metrics/logs
- `k top pods` - to get pod logs
- `k top nodes --sort-by='cpu' --no-headers | head -1` - logs sorted by cpu & head -1 is for only get 1st resource which highly used CPU
- `k top pods --sort-by='memory' --no-headers | head -1` - get logs of pods sorted by memory

## Inspect the logs of kubernetes components
- `k logs <podname>` - to get logs of a specific pod
- `k logs <podname>  <containername>` - If you have multiple containers in the k8s pod you can specify the -c flag or container name to get logs.
